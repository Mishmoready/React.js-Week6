<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Shopping List</title>
  </head>

  <body>
    <h1>Shopping List</h1>

    <input type="text" id="item" placeholder="Item. e.g. Tomato" /> X
    <input type="number" id="qty" placeholder="Quantity. e.g. 1" />
    <button onclick="addItem()">Add item to list</button>
    <p id="display"></p>
    <hr />
    <h1>Shopping Basket</h1>
    <p>
      Enter all the products you've put into your shopping basket, separated by commas, to see if you've forgotten anything.
    </p>
    <input type="text" id="shoppingBasket" placeholder="e.g. tomato,eggs,milk" />
    <input type="button" value="Add items in basket" onclick="checkItems();" />
    <p id="reminder"></p>
    <script>
      "use strict";

      const basket = document.getElementById("shoppingBasket");
      //shoppingList is an array [] of objects { item, quantity }
      let shoppingList = [];
      function addItem() {
        //Create an Object and then add the object into shoppingList array
        const itemToAdd = {
          item: document.getElementById("item").value,
          quantity: document.getElementById("qty").value,
        };
        shoppingList.push(itemToAdd);
        displayList();
      }
      function displayList() {
        //clear the display
        document.getElementById("display").innerHTML = "";
        //for each item in the shoppingList array, display item, quantity, and a delete button
        for (let shoppingListItem of shoppingList) {
          document.getElementById("display").innerHTML += `${shoppingListItem.item} x ${
            shoppingListItem.quantity
          } <span style="cursor: pointer" onclick="deleteItem(${shoppingList.indexOf(
            shoppingListItem
          )})">&#10062;</span><br />`;
        }
      }

      function deleteItem(itemToDelete) {
        //delete the item use splice method
        shoppingList.splice(itemToDelete, 1);
        displayList();
      }

      //-------------------------Shopping basket-------------------------
      function checkItems() {
        //split user input into an array
        const splitBasket = basket.value.toLowerCase().split(",");

        // filter returns a new array of elements that contain pass a condition
        const itemsStillToBuy = shoppingList.filter(function (shoppingListElement) {
          const itemFromShoppingList = shoppingListElement.item.toLowerCase();
          // Condition: Check to see if the basket array includes the shopping list item (of the currently looping element).
          // If the element does exist in the basket array, do NOT return true and so do NOT add the current element to the filtered array (Because of the NOT operator)
          return !splitBasket.includes(itemFromShoppingList);
        });

        //if itemsStillToBuy is not empty, then display all items in the itemsStillToBuy
        if (itemsStillToBuy.length !== 0) {
          document.getElementById("reminder").innerHTML = "Here are the items you still need to get:<br />";
          //display itemsStillToBuy
          for (let itemStillToBuy of itemsStillToBuy) {
            document.getElementById("reminder").innerHTML += `${itemStillToBuy.item} x ${itemStillToBuy.quantity} <br />`;
          }
        } else {
          document.getElementById("reminder").innerHTML = "------YOU GOT EVERYTHING üòè------";
        }
      }
    </script>
  </body>
</html>
