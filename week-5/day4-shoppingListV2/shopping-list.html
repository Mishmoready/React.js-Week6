<!DOCTYPE html>
<!-- I refactored this code slightly, to make it more easier to understand. -->
<html lang="en">
  <head>
    <title>Shopping List</title>
  </head>

  <body>
    <p style="font-style: italic; border: dashed 2px red; padding: 5px; text-align: center">
      I refactored this code slightly, to make it more easier to understand.
    </p>
    <h1>Shopping List</h1>

    <input type="text" id="item" placeholder="Item. e.g. Tomato" /> x
    <input type="number" id="qty" placeholder="Quantity. e.g. 1" />
    <button onclick="addItem()">Add item to list</button>
    <p id="shopping-list-display"></p>
    <hr />
    <h1>Shopping Basket</h1>
    <p>
      Enter all the products you've put into your shopping basket, separated by commas, to see if you've forgotten anything.
    </p>
    <input type="text" id="shoppingBasket" placeholder="e.g. tomato,eggs,milk" />
    <input type="button" value="Add item(s) to basket" onclick="addToBasket();" />
    <p id="forgotten-items-display"></p>
    <script>
      "use strict";

      //shoppingList is an array [] of objects { item, quantity }
      const shoppingList = [];

      function addItem() {
        //Create an Object and then add the object into shoppingList array
        const itemToAdd = {
          item: document.getElementById("item").value,
          quantity: document.getElementById("qty").value,
        };
        shoppingList.push(itemToAdd);
        displayList();
      }

      function displayList() {
        //clear the display
        document.getElementById("shopping-list-display").innerHTML = "";
        //for each item in the shoppingList array, display item, quantity, and a delete button
        for (let shoppingListEl of shoppingList) {
          //update the HTML to what is currently rendered, plus a new string
          document.getElementById("shopping-list-display").innerHTML += `${shoppingListEl.item} x ${shoppingListEl.quantity} 
          <span style="cursor: pointer" onclick="deleteItem(${shoppingList.indexOf(shoppingListEl)})">&#10062</span><br/>`;
        }
      }

      function deleteItem(itemToDelete) {
        //delete the item using the splice method
        shoppingList.splice(itemToDelete, 1); // itemToDelete is the index we want to delete from, 1 is the number of elements to delete from that starting index
        displayList();
      }

      //-------------------------Shopping basket-------------------------
      function addToBasket() {
        //split user input into an array
        const basket = document.getElementById("shoppingBasket").value.toLowerCase().split(",");

        //filter() returns a new array of elements that contain pass a condition
        const forgottenItems = shoppingList.filter(function (shoppingListEl) {
          // Condition: Check to see if the basket array includes the shopping list item (of the currently looping element).
          // If the element does exist in the basket array, do NOT return true and so do NOT add the current element to the filtered array (Because of the NOT operator)
          return !basket.includes(shoppingListEl.item.toLowerCase());
        });

        //if forgottenItems array is empty, then display a success message
        if (forgottenItems.length === 0) {
          document.getElementById("forgotten-items-display").innerHTML = "------YOU GOT EVERYTHING üòè------";
        } else {
          //if forgottenItems is not empty, then display all items in the forgottenItems array
          document.getElementById("forgotten-items-display").innerHTML = "Here are the items you still need to get:<br/>";
          //display forgottenItems
          for (let forgottenItemEl of forgottenItems) {
            //update the HTML to what is currently rendered, plus a new string
            document.getElementById(
              "forgotten-items-display"
            ).innerHTML += `${forgottenItemEl.item} x ${forgottenItemEl.quantity} <br />`;
          }
        }
      }
    </script>
  </body>
</html>
